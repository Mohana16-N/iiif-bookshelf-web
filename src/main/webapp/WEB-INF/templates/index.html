<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="base">
    <body>
        <section layout:fragment="content">

            <div class="row">
                <div class="col-md-4">
                    <div class="table-pagination">
                        <ul class="pagination pagination-sm">
                            <li th:class="${page.number eq 0} ? 'disabled' : ''">
                                <a th:if="${not page.first}" aria-label="First" th:href="@{${'/'}(page=0,size=${page.size})}"><span class="glyphicon glyphicon-fast-backward"></span></a>
                                <a th:if="${page.first}" aria-label="First" href="javascript:void(0);"><span class="glyphicon glyphicon-fast-backward"></span></a>
                            </li>
                            <li th:class="${page.number eq 0} ? 'disabled' : ''">
                                <a th:if="${not page.first}" aria-label="Previous" th:href="@{${'/'}(page=${page.number-1},size=${page.size})}"><span class="glyphicon glyphicon-backward"></span></a>
                                <a th:if="${page.first}" aria-label="Previous" href="javascript:void(0);"><span class="glyphicon glyphicon-backward"></span></a>
                            </li>

                            <li th:each="pageNo : ${#numbers.sequence(0, page.totalPages - 1)}" th:class="${page.number eq pageNo}? 'active' : ''">
                                <a th:if="${page.number  eq pageNo}" href="javascript:void(0);">
                                    <span th:text="${pageNo + 1}"></span>
                                </a>
                                <a th:if="${not (page.number  eq pageNo)}" th:href="@{${'/'}(page=${pageNo},size=${page.size})}">
                                    <span th:text="${pageNo + 1}"></span>
                                </a>
                            </li>

                            <li th:class="${page.number + 1 ge page.totalPages} ? 'disabled' : ''">
                                <a th:if="${not page.last}" aria-label="Next" th:href="@{${'/'}(page=${page.number+1},size=${page.size})}"><span class="glyphicon glyphicon-forward"></span></a>
                                <a th:if="${page.last}" aria-label="Next" href="javascript:void(0);"><span class="glyphicon glyphicon-forward"></span></a>
                            </li>
                            <li th:class="${page.number + 1 eq page.totalPages} ? 'disabled' : ''">
                                <a th:if="${not page.last}" aria-label="Last" th:href="@{${'/'}(page=${page.totalPages - 1},size=${page.size})}"><span class="glyphicon glyphicon-fast-forward"></span></a>
                                <a th:if="${page.last}" aria-label="Last" href="javascript:void(0);"><span class="glyphicon glyphicon-fast-forward"></span></a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-4">
                    <form action="#" th:action="@{/find}" th:object="${searchRequest}" method="post">
                        <div class="row">
                            <div class="col-md-10">
                                <input type="text" name="searchText" th:field="*{term}" class="form-control"/>
                            </div>
                            <div class="col-md-2">
                                <button name="submit" type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col-md-3">
                    Found <span th:text="${page.totalElements}">17</span> books. Current language is <em th:text='${#locale.language}'>de</em>
                </div>
                <div class="col-md-1" style="text-align: right;">
                    <p><a class="btn btn-primary" th:href="@{/add}" role="button">add <span class="glyphicon glyphicon-book" aria-hidden="true"></span></a></p>
                </div>
            </div>

            <table class="table table-hover table-condensed">
                <tr th:each="manifest : ${page.content}">
                    <td>
                <th:block th:if="${manifest.thumbnail} != null">
                    <th:block th:if="${manifest.thumbnail.iiifImageApiVersion} != null">
                        <img th:if="${manifest.thumbnail.iiifImageApiVersion.toString()} eq 'V1_1'" th:src="|${manifest.thumbnail.iiifImageServiceUri}/full/,90/0/native.jpg|"/>
                        <img th:if="${manifest.thumbnail.iiifImageApiVersion.toString()} eq 'V2'" th:src="|${manifest.thumbnail.iiifImageServiceUri}/full/,90/0/default.jpg|"/>
                    </th:block>
                    <th:block th:if="${manifest.thumbnail.iiifImageApiVersion} == null">
                        <th:block th:if="${manifest.version} != null">
                            <img th:if="${manifest.version.toString()} eq 'V1'" th:src="|${manifest.thumbnail.iiifImageServiceUri}/full/,90/0/native.jpg|"/>
                            <img th:if="${manifest.version.toString()} eq 'V2'" th:src="|${manifest.thumbnail.iiifImageServiceUri}/full/,90/0/default.jpg|"/>
                        </th:block>
                        <th:block th:if="${manifest.version} == null">
                            <img th:src="|${manifest.thumbnail.iiifImageServiceUri}/full/,90/0/default.jpg|"/>
                        </th:block>
                    </th:block>
                </th:block>
                </td>
                <!--                    <td th:text="${manifest.manifestUri}">URI</td>-->
                <td>
                    <!-- ${#maps.containsKey(map, key)} -->
                    <b th:text="${manifest.labels.isEmpty()} ? '' : (${manifest.labels.get(__${#locale.language}__) != null? manifest.labels.get(__${#locale.language}__) : manifest.labels.values().toArray()[0]})">label</b><br/>
                    <span class="description" th:text="${manifest.descriptions.isEmpty()} ? '' : (${manifest.descriptions.get(__${#locale.language}__) != null? manifest.descriptions.get(__${#locale.language}__) : manifest.descriptions.values().toArray()[0]})">description</span><br/>
                    <em th:text="${manifest.attributions.isEmpty()} ? '' : (${manifest.attributions.get(__${#locale.language}__) != null? manifest.attributions.get(__${#locale.language}__) : manifest.attributions.values().toArray()[0]})">attribution</em><br/>
                    <a th:href="${manifest.manifestUri}" target="_blank">IIIF-Manifest</a><br/>
                </td>

                <td>
                    <a class="btn btn-primary btn-xs" th:href="@{/view/__${manifest.uuid}__}"><span class="glyphicon glyphicon-chevron-right"></span> read</a>
                </td>
                </tr>
            </table>

        </section>

    <th:block layout:fragment="morejs">
        <script type="text/javascript" th:src="@{/js/jquery.shorten.js}"></script>

        <script language="javascript">
            $(document).ready(function () {
                $(".description").shorten({showChars: 150});
            });
        </script>
    </th:block>
</body>
</html>
